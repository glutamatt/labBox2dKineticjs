<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
      canvas {
        border: 1px solid #9C9898;
      }
    </style>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v3.10.0.js"></script>
    <script type="text/javascript" src="https://raw.github.com/joelgwebber/bench2d/master/js/Box2dWeb-2.1a.3/Box2dWeb-2.1.a.3.min.js"></script>
    <script>
    
var coefTest = 30 ;


    //box2d
var   b2Vec2 = Box2D.Common.Math.b2Vec2
         	,	b2BodyDef = Box2D.Dynamics.b2BodyDef
         	,	b2Body = Box2D.Dynamics.b2Body
         	,	b2FixtureDef = Box2D.Dynamics.b2FixtureDef
         	,	b2Fixture = Box2D.Dynamics.b2Fixture
         	,	b2World = Box2D.Dynamics.b2World
         	,	b2MassData = Box2D.Collision.Shapes.b2MassData
         	,	b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape
         	,	b2CircleShape = Box2D.Collision.Shapes.b2CircleShape
         	,	b2DebugDraw = Box2D.Dynamics.b2DebugDraw
            ;
            
            
world = new b2World(
 new b2Vec2(0, 10)    //gravity
 ,  true                 //allow sleep
 );          
var fixDef = new b2FixtureDef;
         fixDef.density = 1.0;
         fixDef.friction = 0.5;
         fixDef.restitution = 0.2;
         
  var bodyDef = new b2BodyDef;
  bodyDef.type = b2Body.b2_dynamicBody;  
       fixDef.shape = new b2PolygonShape;
               fixDef.shape.SetAsBox(
                     0.5 //half width
                  ,  0.7 //half height
               ); 
                bodyDef.position.x = 0;
            bodyDef.position.y = 0;
            var testBody = world.CreateBody(bodyDef);
            testBody.CreateFixture(fixDef); 
            
            testBody.ApplyImpulse(new b2Vec2(8,0), new b2Vec2(testBody.GetPosition().x,testBody.GetPosition().y ));
            
            
            
             var bodyDef = new b2BodyDef;
  bodyDef.type = b2Body.b2_dynamicBody;  
       fixDef.shape = new b2PolygonShape;
               fixDef.shape.SetAsBox(
                     0.5 //half width
                  ,  0.7 //half height
               ); 
                bodyDef.position.x = 10;
            bodyDef.position.y =0.5;
            var testBody2 = world.CreateBody(bodyDef);
            testBody2.CreateFixture(fixDef); 
            
            testBody2.ApplyImpulse(new b2Vec2(-8,0), new b2Vec2(testBody.GetPosition().x,testBody.GetPosition().y ));
            
    
      //groud
      bodyDef.type = b2Body.b2_staticBody;  
      fixDef.shape = new b2PolygonShape;
fixDef.shape.SetAsBox(10, 1);
      bodyDef.position.y = 295 / coefTest ;
      bodyDef.position.x = 0;
world.CreateBody(bodyDef).CreateFixture(fixDef); 



      window.onload = function() {
      
      
       //setup debug draw
         var debugDraw = new b2DebugDraw();
			debugDraw.SetSprite(document.getElementById("canvas").getContext("2d"));
			debugDraw.SetDrawScale(30.0);
			debugDraw.SetFillAlpha(0.3);
			debugDraw.SetLineThickness(1.0);
			debugDraw.SetFlags(b2DebugDraw.e_shapeBit | b2DebugDraw.e_jointBit);
			world.SetDebugDraw(debugDraw);  
			
			
        var stage = new Kinetic.Stage({
          container: "container",
          width: 300,
          height: 300
        });
        var layer = new Kinetic.Layer();


        var hexagon = new Kinetic.Rect({
          x: 0,
          y: 0,
          width: coefTest,
          height: 1.4 * coefTest,
          fill: "#00D2FF",
          stroke: "black",
          strokeWidth: 4,
          offset: [coefTest / 2 , 1.4 * coefTest / 2]
        });
        
         var hexagon2 = new Kinetic.Rect({
          x: 0,
          y: 0,
          width: coefTest,
          height: 1.4 * coefTest,
          fill: "#00D2FF",
          stroke: "red",
          strokeWidth: 4,
          offset: [Math.round(coefTest / 2) , Math.round(1.4 * coefTest / 2)]
        });

        layer.add(hexagon);        layer.add(hexagon2);
        stage.add(layer);

        var amplitude = 150;
        var period = 2000;
        // in ms
        var centerX = stage.getWidth() / 2;

        stage.onFrame(function(frame) {
        
       world.Step(
               1 / 60   //frame-rate
            ,  10       //velocity iterations
            ,  10       //position iterations
         );
         world.DrawDebugData();
         world.ClearForces();
         world.DrawDebugData();
       
			hexagon.setX((testBody.GetPosition().x -0.5) * coefTest );
			hexagon.setY((testBody.GetPosition().y -0.7) * coefTest );
			hexagon.setRotation(testBody.GetAngle());
			
			
			hexagon2.setX((testBody2.GetPosition().x -0.5) * coefTest);
			hexagon2.setY((testBody2.GetPosition().y -0.7) * coefTest);
			hexagon2.setRotation(testBody2.GetAngle());
			
          layer.draw();
        });

        stage.start();
      };

    </script>
  </head>
  <body>
    <div id="container"></div>
    <canvas id="canvas" width="300" height="300"></canvas>
  </body>
</html>
